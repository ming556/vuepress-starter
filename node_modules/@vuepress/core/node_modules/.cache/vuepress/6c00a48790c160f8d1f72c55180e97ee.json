{"remainingRequest":"D:\\项目\\My_project\\vuepress-starter\\vuepress-starter\\node_modules\\babel-loader\\lib\\index.js??ref--3-1!D:\\项目\\My_project\\vuepress-starter\\vuepress-starter\\node_modules\\ejs\\lib\\ejs.js","dependencies":[{"path":"D:\\项目\\My_project\\vuepress-starter\\vuepress-starter\\node_modules\\ejs\\lib\\ejs.js","mtime":1591948923040},{"path":"D:\\项目\\My_project\\vuepress-starter\\vuepress-starter\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1591862511060},{"path":"D:\\项目\\My_project\\vuepress-starter\\vuepress-starter\\node_modules\\babel-loader\\lib\\index.js","mtime":1591862511204}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyoKICogRUpTIEVtYmVkZGVkIEphdmFTY3JpcHQgdGVtcGxhdGVzCiAqIENvcHlyaWdodCAyMTEyIE1hdHRoZXcgRWVybmlzc2UgKG1kZUBmbGVlZ2l4Lm9yZykKICoKICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqICAgICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqCiovCid1c2Ugc3RyaWN0JzsKLyoqCiAqIEBmaWxlIEVtYmVkZGVkIEphdmFTY3JpcHQgdGVtcGxhdGluZyBlbmdpbmUuIHtAbGluayBodHRwOi8vZWpzLmNvfQogKiBAYXV0aG9yIE1hdHRoZXcgRWVybmlzc2UgPG1kZUBmbGVlZ2l4Lm9yZz4KICogQGF1dGhvciBUaWFuY2hlbmcgIlRpbW90aHkiIEd1IDx0aW1vdGh5Z3U5OUBnbWFpbC5jb20+CiAqIEBwcm9qZWN0IEVKUwogKiBAbGljZW5zZSB7QGxpbmsgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMH0KICovCgovKioKICogRUpTIGludGVybmFsIGZ1bmN0aW9ucy4KICoKICogVGVjaG5pY2FsbHkgdGhpcyAibW9kdWxlIiBsaWVzIGluIHRoZSBzYW1lIGZpbGUgYXMge0BsaW5rIG1vZHVsZTplanN9LCBmb3IKICogdGhlIHNha2Ugb2Ygb3JnYW5pemF0aW9uIGFsbCB0aGUgcHJpdmF0ZSBmdW5jdGlvbnMgcmUgZ3JvdXBlZCBpbnRvIHRoaXMKICogbW9kdWxlLgogKgogKiBAbW9kdWxlIGVqcy1pbnRlcm5hbAogKiBAcHJpdmF0ZQogKi8KCi8qKgogKiBFbWJlZGRlZCBKYXZhU2NyaXB0IHRlbXBsYXRpbmcgZW5naW5lLgogKgogKiBAbW9kdWxlIGVqcwogKiBAcHVibGljCiAqLwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pcy1hcnJheSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5sYXN0LWluZGV4LW9mIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb21lIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuZGF0ZS50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuY29uc3RydWN0b3IiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2giKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giKTsKCnZhciBmcyA9IHJlcXVpcmUoJ2ZzJyk7Cgp2YXIgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTsKCnZhciB1dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTsKCnZhciBzY29wZU9wdGlvbldhcm5lZCA9IGZhbHNlOwoKdmFyIF9WRVJTSU9OX1NUUklORyA9IHJlcXVpcmUoJy4uL3BhY2thZ2UuanNvbicpLnZlcnNpb247Cgp2YXIgX0RFRkFVTFRfT1BFTl9ERUxJTUlURVIgPSAnPCc7CnZhciBfREVGQVVMVF9DTE9TRV9ERUxJTUlURVIgPSAnPic7CnZhciBfREVGQVVMVF9ERUxJTUlURVIgPSAnJSc7CnZhciBfREVGQVVMVF9MT0NBTFNfTkFNRSA9ICdsb2NhbHMnOwp2YXIgX05BTUUgPSAnZWpzJzsKdmFyIF9SRUdFWF9TVFJJTkcgPSAnKDwlJXwlJT58PCU9fDwlLXw8JV98PCUjfDwlfCU+fC0lPnxfJT4pJzsKdmFyIF9PUFRTX1BBU1NBQkxFX1dJVEhfREFUQSA9IFsnZGVsaW1pdGVyJywgJ3Njb3BlJywgJ2NvbnRleHQnLCAnZGVidWcnLCAnY29tcGlsZURlYnVnJywgJ2NsaWVudCcsICdfd2l0aCcsICdybVdoaXRlc3BhY2UnLCAnc3RyaWN0JywgJ2ZpbGVuYW1lJywgJ2FzeW5jJ107IC8vIFdlIGRvbid0IGFsbG93ICdjYWNoZScgb3B0aW9uIHRvIGJlIHBhc3NlZCBpbiB0aGUgZGF0YSBvYmogZm9yCi8vIHRoZSBub3JtYWwgYHJlbmRlcmAgY2FsbCwgYnV0IHRoaXMgaXMgd2hlcmUgRXhwcmVzcyAyICYgMyBwdXQgaXQKLy8gc28gd2UgbWFrZSBhbiBleGNlcHRpb24gZm9yIGByZW5kZXJGaWxlYAoKdmFyIF9PUFRTX1BBU1NBQkxFX1dJVEhfREFUQV9FWFBSRVNTID0gX09QVFNfUEFTU0FCTEVfV0lUSF9EQVRBLmNvbmNhdCgnY2FjaGUnKTsKCnZhciBfQk9NID0gL15cdUZFRkYvOwovKioKICogRUpTIHRlbXBsYXRlIGZ1bmN0aW9uIGNhY2hlLiBUaGlzIGNhbiBiZSBhIExSVSBvYmplY3QgZnJvbSBscnUtY2FjaGUgTlBNCiAqIG1vZHVsZS4gQnkgZGVmYXVsdCwgaXQgaXMge0BsaW5rIG1vZHVsZTp1dGlscy5jYWNoZX0sIGEgc2ltcGxlIGluLXByb2Nlc3MKICogY2FjaGUgdGhhdCBncm93cyBjb250aW51b3VzbHkuCiAqCiAqIEB0eXBlIHtDYWNoZX0KICovCgpleHBvcnRzLmNhY2hlID0gdXRpbHMuY2FjaGU7Ci8qKgogKiBDdXN0b20gZmlsZSBsb2FkZXIuIFVzZWZ1bCBmb3IgdGVtcGxhdGUgcHJlcHJvY2Vzc2luZyBvciByZXN0cmljdGluZyBhY2Nlc3MKICogdG8gYSBjZXJ0YWluIHBhcnQgb2YgdGhlIGZpbGVzeXN0ZW0uCiAqCiAqIEB0eXBlIHtmaWxlTG9hZGVyfQogKi8KCmV4cG9ydHMuZmlsZUxvYWRlciA9IGZzLnJlYWRGaWxlU3luYzsKLyoqCiAqIE5hbWUgb2YgdGhlIG9iamVjdCBjb250YWluaW5nIHRoZSBsb2NhbHMuCiAqCiAqIFRoaXMgdmFyaWFibGUgaXMgb3ZlcnJpZGRlbiBieSB7QGxpbmsgT3B0aW9uc31gLmxvY2Fsc05hbWVgIGlmIGl0IGlzIG5vdAogKiBgdW5kZWZpbmVkYC4KICoKICogQHR5cGUge1N0cmluZ30KICogQHB1YmxpYwogKi8KCmV4cG9ydHMubG9jYWxzTmFtZSA9IF9ERUZBVUxUX0xPQ0FMU19OQU1FOwovKioKICogUHJvbWlzZSBpbXBsZW1lbnRhdGlvbiAtLSBkZWZhdWx0cyB0byB0aGUgbmF0aXZlIGltcGxlbWVudGF0aW9uIGlmIGF2YWlsYWJsZQogKiBUaGlzIGlzIG1vc3RseSBqdXN0IGZvciB0ZXN0YWJpbGl0eQogKgogKiBAdHlwZSB7RnVuY3Rpb259CiAqIEBwdWJsaWMKICovCgpleHBvcnRzLnByb21pc2VJbXBsID0gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpczsnKSgpLlByb21pc2U7Ci8qKgogKiBHZXQgdGhlIHBhdGggdG8gdGhlIGluY2x1ZGVkIGZpbGUgZnJvbSB0aGUgcGFyZW50IGZpbGUgcGF0aCBhbmQgdGhlCiAqIHNwZWNpZmllZCBwYXRoLgogKgogKiBAcGFyYW0ge1N0cmluZ30gIG5hbWUgICAgIHNwZWNpZmllZCBwYXRoCiAqIEBwYXJhbSB7U3RyaW5nfSAgZmlsZW5hbWUgcGFyZW50IGZpbGUgcGF0aAogKiBAcGFyYW0ge0Jvb2xlYW59IGlzRGlyICAgIHBhcmVudCBmaWxlIHBhdGggd2hldGhlciBpcyBkaXJlY3RvcnkKICogQHJldHVybiB7U3RyaW5nfQogKi8KCmV4cG9ydHMucmVzb2x2ZUluY2x1ZGUgPSBmdW5jdGlvbiAobmFtZSwgZmlsZW5hbWUsIGlzRGlyKSB7CiAgdmFyIGRpcm5hbWUgPSBwYXRoLmRpcm5hbWU7CiAgdmFyIGV4dG5hbWUgPSBwYXRoLmV4dG5hbWU7CiAgdmFyIHJlc29sdmUgPSBwYXRoLnJlc29sdmU7CiAgdmFyIGluY2x1ZGVQYXRoID0gcmVzb2x2ZShpc0RpciA/IGZpbGVuYW1lIDogZGlybmFtZShmaWxlbmFtZSksIG5hbWUpOwogIHZhciBleHQgPSBleHRuYW1lKG5hbWUpOwoKICBpZiAoIWV4dCkgewogICAgaW5jbHVkZVBhdGggKz0gJy5lanMnOwogIH0KCiAgcmV0dXJuIGluY2x1ZGVQYXRoOwp9OwovKioKICogR2V0IHRoZSBwYXRoIHRvIHRoZSBpbmNsdWRlZCBmaWxlIGJ5IE9wdGlvbnMKICoKICogQHBhcmFtICB7U3RyaW5nfSAgcGF0aCAgICBzcGVjaWZpZWQgcGF0aAogKiBAcGFyYW0gIHtPcHRpb25zfSBvcHRpb25zIGNvbXBpbGF0aW9uIG9wdGlvbnMKICogQHJldHVybiB7U3RyaW5nfQogKi8KCgpmdW5jdGlvbiBnZXRJbmNsdWRlUGF0aChwYXRoLCBvcHRpb25zKSB7CiAgdmFyIGluY2x1ZGVQYXRoOwogIHZhciBmaWxlUGF0aDsKICB2YXIgdmlld3MgPSBvcHRpb25zLnZpZXdzOwogIHZhciBtYXRjaCA9IC9eW0EtWmEtel0rOlxcfF5cLy8uZXhlYyhwYXRoKTsgLy8gQWJzIHBhdGgKCiAgaWYgKG1hdGNoICYmIG1hdGNoLmxlbmd0aCkgewogICAgaW5jbHVkZVBhdGggPSBleHBvcnRzLnJlc29sdmVJbmNsdWRlKHBhdGgucmVwbGFjZSgvXlwvKi8sICcnKSwgb3B0aW9ucy5yb290IHx8ICcvJywgdHJ1ZSk7CiAgfSAvLyBSZWxhdGl2ZSBwYXRocwogIGVsc2UgewogICAgICAvLyBMb29rIHJlbGF0aXZlIHRvIGEgcGFzc2VkIGZpbGVuYW1lIGZpcnN0CiAgICAgIGlmIChvcHRpb25zLmZpbGVuYW1lKSB7CiAgICAgICAgZmlsZVBhdGggPSBleHBvcnRzLnJlc29sdmVJbmNsdWRlKHBhdGgsIG9wdGlvbnMuZmlsZW5hbWUpOwoKICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyhmaWxlUGF0aCkpIHsKICAgICAgICAgIGluY2x1ZGVQYXRoID0gZmlsZVBhdGg7CiAgICAgICAgfQogICAgICB9IC8vIFRoZW4gbG9vayBpbiBhbnkgdmlld3MgZGlyZWN0b3JpZXMKCgogICAgICBpZiAoIWluY2x1ZGVQYXRoKSB7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmlld3MpICYmIHZpZXdzLnNvbWUoZnVuY3Rpb24gKHYpIHsKICAgICAgICAgIGZpbGVQYXRoID0gZXhwb3J0cy5yZXNvbHZlSW5jbHVkZShwYXRoLCB2LCB0cnVlKTsKICAgICAgICAgIHJldHVybiBmcy5leGlzdHNTeW5jKGZpbGVQYXRoKTsKICAgICAgICB9KSkgewogICAgICAgICAgaW5jbHVkZVBhdGggPSBmaWxlUGF0aDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghaW5jbHVkZVBhdGgpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBmaW5kIHRoZSBpbmNsdWRlIGZpbGUgIicgKyBvcHRpb25zLmVzY2FwZUZ1bmN0aW9uKHBhdGgpICsgJyInKTsKICAgICAgfQogICAgfQoKICByZXR1cm4gaW5jbHVkZVBhdGg7Cn0KLyoqCiAqIEdldCB0aGUgdGVtcGxhdGUgZnJvbSBhIHN0cmluZyBvciBhIGZpbGUsIGVpdGhlciBjb21waWxlZCBvbi10aGUtZmx5IG9yCiAqIHJlYWQgZnJvbSBjYWNoZSAoaWYgZW5hYmxlZCksIGFuZCBjYWNoZSB0aGUgdGVtcGxhdGUgaWYgbmVlZGVkLgogKgogKiBJZiBgdGVtcGxhdGVgIGlzIG5vdCBzZXQsIHRoZSBmaWxlIHNwZWNpZmllZCBpbiBgb3B0aW9ucy5maWxlbmFtZWAgd2lsbCBiZQogKiByZWFkLgogKgogKiBJZiBgb3B0aW9ucy5jYWNoZWAgaXMgdHJ1ZSwgdGhpcyBmdW5jdGlvbiByZWFkcyB0aGUgZmlsZSBmcm9tCiAqIGBvcHRpb25zLmZpbGVuYW1lYCBzbyBpdCBtdXN0IGJlIHNldCBwcmlvciB0byBjYWxsaW5nIHRoaXMgZnVuY3Rpb24uCiAqCiAqIEBtZW1iZXJvZiBtb2R1bGU6ZWpzLWludGVybmFsCiAqIEBwYXJhbSB7T3B0aW9uc30gb3B0aW9ucyAgIGNvbXBpbGF0aW9uIG9wdGlvbnMKICogQHBhcmFtIHtTdHJpbmd9IFt0ZW1wbGF0ZV0gdGVtcGxhdGUgc291cmNlCiAqIEByZXR1cm4geyhUZW1wbGF0ZUZ1bmN0aW9ufENsaWVudEZ1bmN0aW9uKX0KICogRGVwZW5kaW5nIG9uIHRoZSB2YWx1ZSBvZiBgb3B0aW9ucy5jbGllbnRgLCBlaXRoZXIgdHlwZSBtaWdodCBiZSByZXR1cm5lZC4KICogQHN0YXRpYwogKi8KCgpmdW5jdGlvbiBoYW5kbGVDYWNoZShvcHRpb25zLCB0ZW1wbGF0ZSkgewogIHZhciBmdW5jOwogIHZhciBmaWxlbmFtZSA9IG9wdGlvbnMuZmlsZW5hbWU7CiAgdmFyIGhhc1RlbXBsYXRlID0gYXJndW1lbnRzLmxlbmd0aCA+IDE7CgogIGlmIChvcHRpb25zLmNhY2hlKSB7CiAgICBpZiAoIWZpbGVuYW1lKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignY2FjaGUgb3B0aW9uIHJlcXVpcmVzIGEgZmlsZW5hbWUnKTsKICAgIH0KCiAgICBmdW5jID0gZXhwb3J0cy5jYWNoZS5nZXQoZmlsZW5hbWUpOwoKICAgIGlmIChmdW5jKSB7CiAgICAgIHJldHVybiBmdW5jOwogICAgfQoKICAgIGlmICghaGFzVGVtcGxhdGUpIHsKICAgICAgdGVtcGxhdGUgPSBmaWxlTG9hZGVyKGZpbGVuYW1lKS50b1N0cmluZygpLnJlcGxhY2UoX0JPTSwgJycpOwogICAgfQogIH0gZWxzZSBpZiAoIWhhc1RlbXBsYXRlKSB7CiAgICAvLyBpc3RhbmJ1bCBpZ25vcmUgaWY6IHNob3VsZCBub3QgaGFwcGVuIGF0IGFsbAogICAgaWYgKCFmaWxlbmFtZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGVybmFsIEVKUyBlcnJvcjogbm8gZmlsZSBuYW1lIG9yIHRlbXBsYXRlICcgKyAncHJvdmlkZWQnKTsKICAgIH0KCiAgICB0ZW1wbGF0ZSA9IGZpbGVMb2FkZXIoZmlsZW5hbWUpLnRvU3RyaW5nKCkucmVwbGFjZShfQk9NLCAnJyk7CiAgfQoKICBmdW5jID0gZXhwb3J0cy5jb21waWxlKHRlbXBsYXRlLCBvcHRpb25zKTsKCiAgaWYgKG9wdGlvbnMuY2FjaGUpIHsKICAgIGV4cG9ydHMuY2FjaGUuc2V0KGZpbGVuYW1lLCBmdW5jKTsKICB9CgogIHJldHVybiBmdW5jOwp9Ci8qKgogKiBUcnkgY2FsbGluZyBoYW5kbGVDYWNoZSB3aXRoIHRoZSBnaXZlbiBvcHRpb25zIGFuZCBkYXRhIGFuZCBjYWxsIHRoZQogKiBjYWxsYmFjayB3aXRoIHRoZSByZXN1bHQuIElmIGFuIGVycm9yIG9jY3VycywgY2FsbCB0aGUgY2FsbGJhY2sgd2l0aAogKiB0aGUgZXJyb3IuIFVzZWQgYnkgcmVuZGVyRmlsZSgpLgogKgogKiBAbWVtYmVyb2YgbW9kdWxlOmVqcy1pbnRlcm5hbAogKiBAcGFyYW0ge09wdGlvbnN9IG9wdGlvbnMgICAgY29tcGlsYXRpb24gb3B0aW9ucwogKiBAcGFyYW0ge09iamVjdH0gZGF0YSAgICAgICAgdGVtcGxhdGUgZGF0YQogKiBAcGFyYW0ge1JlbmRlckZpbGVDYWxsYmFja30gY2IgY2FsbGJhY2sKICogQHN0YXRpYwogKi8KCgpmdW5jdGlvbiB0cnlIYW5kbGVDYWNoZShvcHRpb25zLCBkYXRhLCBjYikgewogIHZhciByZXN1bHQ7CgogIGlmICghY2IpIHsKICAgIGlmICh0eXBlb2YgZXhwb3J0cy5wcm9taXNlSW1wbCA9PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybiBuZXcgZXhwb3J0cy5wcm9taXNlSW1wbChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJlc3VsdCA9IGhhbmRsZUNhY2hlKG9wdGlvbnMpKGRhdGEpOwogICAgICAgICAgcmVzb2x2ZShyZXN1bHQpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgcmVqZWN0KGVycik7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignUGxlYXNlIHByb3ZpZGUgYSBjYWxsYmFjayBmdW5jdGlvbicpOwogICAgfQogIH0gZWxzZSB7CiAgICB0cnkgewogICAgICByZXN1bHQgPSBoYW5kbGVDYWNoZShvcHRpb25zKShkYXRhKTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICByZXR1cm4gY2IoZXJyKTsKICAgIH0KCiAgICBjYihudWxsLCByZXN1bHQpOwogIH0KfQovKioKICogZmlsZUxvYWRlciBpcyBpbmRlcGVuZGVudAogKgogKiBAcGFyYW0ge1N0cmluZ30gZmlsZVBhdGggZWpzIGZpbGUgcGF0aC4KICogQHJldHVybiB7U3RyaW5nfSBUaGUgY29udGVudHMgb2YgdGhlIHNwZWNpZmllZCBmaWxlLgogKiBAc3RhdGljCiAqLwoKCmZ1bmN0aW9uIGZpbGVMb2FkZXIoZmlsZVBhdGgpIHsKICByZXR1cm4gZXhwb3J0cy5maWxlTG9hZGVyKGZpbGVQYXRoKTsKfQovKioKICogR2V0IHRoZSB0ZW1wbGF0ZSBmdW5jdGlvbi4KICoKICogSWYgYG9wdGlvbnMuY2FjaGVgIGlzIGB0cnVlYCwgdGhlbiB0aGUgdGVtcGxhdGUgaXMgY2FjaGVkLgogKgogKiBAbWVtYmVyb2YgbW9kdWxlOmVqcy1pbnRlcm5hbAogKiBAcGFyYW0ge1N0cmluZ30gIHBhdGggICAgcGF0aCBmb3IgdGhlIHNwZWNpZmllZCBmaWxlCiAqIEBwYXJhbSB7T3B0aW9uc30gb3B0aW9ucyBjb21waWxhdGlvbiBvcHRpb25zCiAqIEByZXR1cm4geyhUZW1wbGF0ZUZ1bmN0aW9ufENsaWVudEZ1bmN0aW9uKX0KICogRGVwZW5kaW5nIG9uIHRoZSB2YWx1ZSBvZiBgb3B0aW9ucy5jbGllbnRgLCBlaXRoZXIgdHlwZSBtaWdodCBiZSByZXR1cm5lZAogKiBAc3RhdGljCiAqLwoKCmZ1bmN0aW9uIGluY2x1ZGVGaWxlKHBhdGgsIG9wdGlvbnMpIHsKICB2YXIgb3B0cyA9IHV0aWxzLnNoYWxsb3dDb3B5KHt9LCBvcHRpb25zKTsKICBvcHRzLmZpbGVuYW1lID0gZ2V0SW5jbHVkZVBhdGgocGF0aCwgb3B0cyk7CiAgcmV0dXJuIGhhbmRsZUNhY2hlKG9wdHMpOwp9Ci8qKgogKiBHZXQgdGhlIEphdmFTY3JpcHQgc291cmNlIG9mIGFuIGluY2x1ZGVkIGZpbGUuCiAqCiAqIEBtZW1iZXJvZiBtb2R1bGU6ZWpzLWludGVybmFsCiAqIEBwYXJhbSB7U3RyaW5nfSAgcGF0aCAgICBwYXRoIGZvciB0aGUgc3BlY2lmaWVkIGZpbGUKICogQHBhcmFtIHtPcHRpb25zfSBvcHRpb25zIGNvbXBpbGF0aW9uIG9wdGlvbnMKICogQHJldHVybiB7T2JqZWN0fQogKiBAc3RhdGljCiAqLwoKCmZ1bmN0aW9uIGluY2x1ZGVTb3VyY2UocGF0aCwgb3B0aW9ucykgewogIHZhciBvcHRzID0gdXRpbHMuc2hhbGxvd0NvcHkoe30sIG9wdGlvbnMpOwogIHZhciBpbmNsdWRlUGF0aDsKICB2YXIgdGVtcGxhdGU7CiAgaW5jbHVkZVBhdGggPSBnZXRJbmNsdWRlUGF0aChwYXRoLCBvcHRzKTsKICB0ZW1wbGF0ZSA9IGZpbGVMb2FkZXIoaW5jbHVkZVBhdGgpLnRvU3RyaW5nKCkucmVwbGFjZShfQk9NLCAnJyk7CiAgb3B0cy5maWxlbmFtZSA9IGluY2x1ZGVQYXRoOwogIHZhciB0ZW1wbCA9IG5ldyBUZW1wbGF0ZSh0ZW1wbGF0ZSwgb3B0cyk7CiAgdGVtcGwuZ2VuZXJhdGVTb3VyY2UoKTsKICByZXR1cm4gewogICAgc291cmNlOiB0ZW1wbC5zb3VyY2UsCiAgICBmaWxlbmFtZTogaW5jbHVkZVBhdGgsCiAgICB0ZW1wbGF0ZTogdGVtcGxhdGUKICB9Owp9Ci8qKgogKiBSZS10aHJvdyB0aGUgZ2l2ZW4gYGVycmAgaW4gY29udGV4dCB0byB0aGUgYHN0cmAgb2YgZWpzLCBgZmlsZW5hbWVgLCBhbmQKICogYGxpbmVub2AuCiAqCiAqIEBpbXBsZW1lbnRzIFJldGhyb3dDYWxsYmFjawogKiBAbWVtYmVyb2YgbW9kdWxlOmVqcy1pbnRlcm5hbAogKiBAcGFyYW0ge0Vycm9yfSAgZXJyICAgICAgRXJyb3Igb2JqZWN0CiAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgICAgICBFSlMgc291cmNlCiAqIEBwYXJhbSB7U3RyaW5nfSBmaWxlbmFtZSBmaWxlIG5hbWUgb2YgdGhlIEVKUyBmaWxlCiAqIEBwYXJhbSB7U3RyaW5nfSBsaW5lbm8gICBsaW5lIG51bWJlciBvZiB0aGUgZXJyb3IKICogQHN0YXRpYwogKi8KCgpmdW5jdGlvbiByZXRocm93KGVyciwgc3RyLCBmbG5tLCBsaW5lbm8sIGVzYykgewogIHZhciBsaW5lcyA9IHN0ci5zcGxpdCgnXG4nKTsKICB2YXIgc3RhcnQgPSBNYXRoLm1heChsaW5lbm8gLSAzLCAwKTsKICB2YXIgZW5kID0gTWF0aC5taW4obGluZXMubGVuZ3RoLCBsaW5lbm8gKyAzKTsKICB2YXIgZmlsZW5hbWUgPSBlc2MoZmxubSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUKICAvLyBFcnJvciBjb250ZXh0CgogIHZhciBjb250ZXh0ID0gbGluZXMuc2xpY2Uoc3RhcnQsIGVuZCkubWFwKGZ1bmN0aW9uIChsaW5lLCBpKSB7CiAgICB2YXIgY3VyciA9IGkgKyBzdGFydCArIDE7CiAgICByZXR1cm4gKGN1cnIgPT0gbGluZW5vID8gJyA+PiAnIDogJyAgICAnKSArIGN1cnIgKyAnfCAnICsgbGluZTsKICB9KS5qb2luKCdcbicpOyAvLyBBbHRlciBleGNlcHRpb24gbWVzc2FnZQoKICBlcnIucGF0aCA9IGZpbGVuYW1lOwogIGVyci5tZXNzYWdlID0gKGZpbGVuYW1lIHx8ICdlanMnKSArICc6JyArIGxpbmVubyArICdcbicgKyBjb250ZXh0ICsgJ1xuXG4nICsgZXJyLm1lc3NhZ2U7CiAgdGhyb3cgZXJyOwp9CgpmdW5jdGlvbiBzdHJpcFNlbWkoc3RyKSB7CiAgcmV0dXJuIHN0ci5yZXBsYWNlKC87KFxzKiQpLywgJyQxJyk7Cn0KLyoqCiAqIENvbXBpbGUgdGhlIGdpdmVuIGBzdHJgIG9mIGVqcyBpbnRvIGEgdGVtcGxhdGUgZnVuY3Rpb24uCiAqCiAqIEBwYXJhbSB7U3RyaW5nfSAgdGVtcGxhdGUgRUpTIHRlbXBsYXRlCiAqCiAqIEBwYXJhbSB7T3B0aW9uc30gb3B0cyAgICAgY29tcGlsYXRpb24gb3B0aW9ucwogKgogKiBAcmV0dXJuIHsoVGVtcGxhdGVGdW5jdGlvbnxDbGllbnRGdW5jdGlvbil9CiAqIERlcGVuZGluZyBvbiB0aGUgdmFsdWUgb2YgYG9wdHMuY2xpZW50YCwgZWl0aGVyIHR5cGUgbWlnaHQgYmUgcmV0dXJuZWQuCiAqIE5vdGUgdGhhdCB0aGUgcmV0dXJuIHR5cGUgb2YgdGhlIGZ1bmN0aW9uIGFsc28gZGVwZW5kcyBvbiB0aGUgdmFsdWUgb2YgYG9wdHMuYXN5bmNgLgogKiBAcHVibGljCiAqLwoKCmV4cG9ydHMuY29tcGlsZSA9IGZ1bmN0aW9uIGNvbXBpbGUodGVtcGxhdGUsIG9wdHMpIHsKICB2YXIgdGVtcGw7IC8vIHYxIGNvbXBhdAogIC8vICdzY29wZScgaXMgJ2NvbnRleHQnCiAgLy8gRklYTUU6IFJlbW92ZSB0aGlzIGluIGEgZnV0dXJlIHZlcnNpb24KCiAgaWYgKG9wdHMgJiYgb3B0cy5zY29wZSkgewogICAgaWYgKCFzY29wZU9wdGlvbldhcm5lZCkgewogICAgICBjb25zb2xlLndhcm4oJ2BzY29wZWAgb3B0aW9uIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBFSlMgMycpOwogICAgICBzY29wZU9wdGlvbldhcm5lZCA9IHRydWU7CiAgICB9CgogICAgaWYgKCFvcHRzLmNvbnRleHQpIHsKICAgICAgb3B0cy5jb250ZXh0ID0gb3B0cy5zY29wZTsKICAgIH0KCiAgICBkZWxldGUgb3B0cy5zY29wZTsKICB9CgogIHRlbXBsID0gbmV3IFRlbXBsYXRlKHRlbXBsYXRlLCBvcHRzKTsKICByZXR1cm4gdGVtcGwuY29tcGlsZSgpOwp9OwovKioKICogUmVuZGVyIHRoZSBnaXZlbiBgdGVtcGxhdGVgIG9mIGVqcy4KICoKICogSWYgeW91IHdvdWxkIGxpa2UgdG8gaW5jbHVkZSBvcHRpb25zIGJ1dCBub3QgZGF0YSwgeW91IG5lZWQgdG8gZXhwbGljaXRseQogKiBjYWxsIHRoaXMgZnVuY3Rpb24gd2l0aCBgZGF0YWAgYmVpbmcgYW4gZW1wdHkgb2JqZWN0IG9yIGBudWxsYC4KICoKICogQHBhcmFtIHtTdHJpbmd9ICAgdGVtcGxhdGUgRUpTIHRlbXBsYXRlCiAqIEBwYXJhbSB7T2JqZWN0fSAgW2RhdGE9e31dIHRlbXBsYXRlIGRhdGEKICogQHBhcmFtIHtPcHRpb25zfSBbb3B0cz17fV0gY29tcGlsYXRpb24gYW5kIHJlbmRlcmluZyBvcHRpb25zCiAqIEByZXR1cm4geyhTdHJpbmd8UHJvbWlzZTxTdHJpbmc+KX0KICogUmV0dXJuIHZhbHVlIHR5cGUgZGVwZW5kcyBvbiBgb3B0cy5hc3luY2AuCiAqIEBwdWJsaWMKICovCgoKZXhwb3J0cy5yZW5kZXIgPSBmdW5jdGlvbiAodGVtcGxhdGUsIGQsIG8pIHsKICB2YXIgZGF0YSA9IGQgfHwge307CiAgdmFyIG9wdHMgPSBvIHx8IHt9OyAvLyBObyBvcHRpb25zIG9iamVjdCAtLSBpZiB0aGVyZSBhcmUgb3B0aW9ueSBuYW1lcwogIC8vIGluIHRoZSBkYXRhLCBjb3B5IHRoZW0gdG8gb3B0aW9ucwoKICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAyKSB7CiAgICB1dGlscy5zaGFsbG93Q29weUZyb21MaXN0KG9wdHMsIGRhdGEsIF9PUFRTX1BBU1NBQkxFX1dJVEhfREFUQSk7CiAgfQoKICByZXR1cm4gaGFuZGxlQ2FjaGUob3B0cywgdGVtcGxhdGUpKGRhdGEpOwp9OwovKioKICogUmVuZGVyIGFuIEVKUyBmaWxlIGF0IHRoZSBnaXZlbiBgcGF0aGAgYW5kIGNhbGxiYWNrIGBjYihlcnIsIHN0cilgLgogKgogKiBJZiB5b3Ugd291bGQgbGlrZSB0byBpbmNsdWRlIG9wdGlvbnMgYnV0IG5vdCBkYXRhLCB5b3UgbmVlZCB0byBleHBsaWNpdGx5CiAqIGNhbGwgdGhpcyBmdW5jdGlvbiB3aXRoIGBkYXRhYCBiZWluZyBhbiBlbXB0eSBvYmplY3Qgb3IgYG51bGxgLgogKgogKiBAcGFyYW0ge1N0cmluZ30gICAgICAgICAgICAgcGF0aCAgICAgcGF0aCB0byB0aGUgRUpTIGZpbGUKICogQHBhcmFtIHtPYmplY3R9ICAgICAgICAgICAgW2RhdGE9e31dIHRlbXBsYXRlIGRhdGEKICogQHBhcmFtIHtPcHRpb25zfSAgICAgICAgICAgW29wdHM9e31dIGNvbXBpbGF0aW9uIGFuZCByZW5kZXJpbmcgb3B0aW9ucwogKiBAcGFyYW0ge1JlbmRlckZpbGVDYWxsYmFja30gY2IgY2FsbGJhY2sKICogQHB1YmxpYwogKi8KCgpleHBvcnRzLnJlbmRlckZpbGUgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpOwogIHZhciBmaWxlbmFtZSA9IGFyZ3Muc2hpZnQoKTsKICB2YXIgY2I7CiAgdmFyIG9wdHMgPSB7CiAgICBmaWxlbmFtZTogZmlsZW5hbWUKICB9OwogIHZhciBkYXRhOwogIHZhciB2aWV3T3B0czsgLy8gRG8gd2UgaGF2ZSBhIGNhbGxiYWNrPwoKICBpZiAodHlwZW9mIGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV0gPT0gJ2Z1bmN0aW9uJykgewogICAgY2IgPSBhcmdzLnBvcCgpOwogIH0gLy8gRG8gd2UgaGF2ZSBkYXRhL29wdHM/CgoKICBpZiAoYXJncy5sZW5ndGgpIHsKICAgIC8vIFNob3VsZCBhbHdheXMgaGF2ZSBkYXRhIG9iagogICAgZGF0YSA9IGFyZ3Muc2hpZnQoKTsgLy8gTm9ybWFsIHBhc3NlZCBvcHRzIChkYXRhIG9iaiArIG9wdHMgb2JqKQoKICAgIGlmIChhcmdzLmxlbmd0aCkgewogICAgICAvLyBVc2Ugc2hhbGxvd0NvcHkgc28gd2UgZG9uJ3QgcG9sbHV0ZSBwYXNzZWQgaW4gb3B0cyBvYmogd2l0aCBuZXcgdmFscwogICAgICB1dGlscy5zaGFsbG93Q29weShvcHRzLCBhcmdzLnBvcCgpKTsKICAgIH0gLy8gU3BlY2lhbCBjYXNpbmcgZm9yIEV4cHJlc3MgKHNldHRpbmdzICsgb3B0cy1pbi1kYXRhKQogICAgZWxzZSB7CiAgICAgICAgLy8gRXhwcmVzcyAzIGFuZCA0CiAgICAgICAgaWYgKGRhdGEuc2V0dGluZ3MpIHsKICAgICAgICAgIC8vIFB1bGwgYSBmZXcgdGhpbmdzIGZyb20ga25vd24gbG9jYXRpb25zCiAgICAgICAgICBpZiAoZGF0YS5zZXR0aW5ncy52aWV3cykgewogICAgICAgICAgICBvcHRzLnZpZXdzID0gZGF0YS5zZXR0aW5ncy52aWV3czsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZGF0YS5zZXR0aW5nc1sndmlldyBjYWNoZSddKSB7CiAgICAgICAgICAgIG9wdHMuY2FjaGUgPSB0cnVlOwogICAgICAgICAgfSAvLyBVbmRvY3VtZW50ZWQgYWZ0ZXIgRXhwcmVzcyAyLCBidXQgc3RpbGwgdXNhYmxlLCBlc3AuIGZvcgogICAgICAgICAgLy8gaXRlbXMgdGhhdCBhcmUgdW5zYWZlIHRvIGJlIHBhc3NlZCBhbG9uZyB3aXRoIGRhdGEsIGxpa2UgYHJvb3RgCgoKICAgICAgICAgIHZpZXdPcHRzID0gZGF0YS5zZXR0aW5nc1sndmlldyBvcHRpb25zJ107CgogICAgICAgICAgaWYgKHZpZXdPcHRzKSB7CiAgICAgICAgICAgIHV0aWxzLnNoYWxsb3dDb3B5KG9wdHMsIHZpZXdPcHRzKTsKICAgICAgICAgIH0KICAgICAgICB9IC8vIEV4cHJlc3MgMiBhbmQgbG93ZXIsIHZhbHVlcyBzZXQgaW4gYXBwLmxvY2Fscywgb3IgcGVvcGxlIHdobyBqdXN0CiAgICAgICAgLy8gd2FudCB0byBwYXNzIG9wdGlvbnMgaW4gdGhlaXIgZGF0YS4gTk9URTogVGhlc2UgdmFsdWVzIHdpbGwgb3ZlcnJpZGUKICAgICAgICAvLyBhbnl0aGluZyBwcmV2aW91c2x5IHNldCBpbiBzZXR0aW5ncyAgb3Igc2V0dGluZ3NbJ3ZpZXcgb3B0aW9ucyddCgoKICAgICAgICB1dGlscy5zaGFsbG93Q29weUZyb21MaXN0KG9wdHMsIGRhdGEsIF9PUFRTX1BBU1NBQkxFX1dJVEhfREFUQV9FWFBSRVNTKTsKICAgICAgfQoKICAgIG9wdHMuZmlsZW5hbWUgPSBmaWxlbmFtZTsKICB9IGVsc2UgewogICAgZGF0YSA9IHt9OwogIH0KCiAgcmV0dXJuIHRyeUhhbmRsZUNhY2hlKG9wdHMsIGRhdGEsIGNiKTsKfTsKLyoqCiAqIENsZWFyIGludGVybWVkaWF0ZSBKYXZhU2NyaXB0IGNhY2hlLiBDYWxscyB7QGxpbmsgQ2FjaGUjcmVzZXR9LgogKiBAcHVibGljCiAqLwoKLyoqCiAqIEVKUyB0ZW1wbGF0ZSBjbGFzcwogKiBAcHVibGljCiAqLwoKCmV4cG9ydHMuVGVtcGxhdGUgPSBUZW1wbGF0ZTsKCmV4cG9ydHMuY2xlYXJDYWNoZSA9IGZ1bmN0aW9uICgpIHsKICBleHBvcnRzLmNhY2hlLnJlc2V0KCk7Cn07CgpmdW5jdGlvbiBUZW1wbGF0ZSh0ZXh0LCBvcHRzKSB7CiAgb3B0cyA9IG9wdHMgfHwge307CiAgdmFyIG9wdGlvbnMgPSB7fTsKICB0aGlzLnRlbXBsYXRlVGV4dCA9IHRleHQ7CiAgdGhpcy5tb2RlID0gbnVsbDsKICB0aGlzLnRydW5jYXRlID0gZmFsc2U7CiAgdGhpcy5jdXJyZW50TGluZSA9IDE7CiAgdGhpcy5zb3VyY2UgPSAnJzsKICB0aGlzLmRlcGVuZGVuY2llcyA9IFtdOwogIG9wdGlvbnMuY2xpZW50ID0gb3B0cy5jbGllbnQgfHwgZmFsc2U7CiAgb3B0aW9ucy5lc2NhcGVGdW5jdGlvbiA9IG9wdHMuZXNjYXBlIHx8IG9wdHMuZXNjYXBlRnVuY3Rpb24gfHwgdXRpbHMuZXNjYXBlWE1MOwogIG9wdGlvbnMuY29tcGlsZURlYnVnID0gb3B0cy5jb21waWxlRGVidWcgIT09IGZhbHNlOwogIG9wdGlvbnMuZGVidWcgPSAhIW9wdHMuZGVidWc7CiAgb3B0aW9ucy5maWxlbmFtZSA9IG9wdHMuZmlsZW5hbWU7CiAgb3B0aW9ucy5vcGVuRGVsaW1pdGVyID0gb3B0cy5vcGVuRGVsaW1pdGVyIHx8IGV4cG9ydHMub3BlbkRlbGltaXRlciB8fCBfREVGQVVMVF9PUEVOX0RFTElNSVRFUjsKICBvcHRpb25zLmNsb3NlRGVsaW1pdGVyID0gb3B0cy5jbG9zZURlbGltaXRlciB8fCBleHBvcnRzLmNsb3NlRGVsaW1pdGVyIHx8IF9ERUZBVUxUX0NMT1NFX0RFTElNSVRFUjsKICBvcHRpb25zLmRlbGltaXRlciA9IG9wdHMuZGVsaW1pdGVyIHx8IGV4cG9ydHMuZGVsaW1pdGVyIHx8IF9ERUZBVUxUX0RFTElNSVRFUjsKICBvcHRpb25zLnN0cmljdCA9IG9wdHMuc3RyaWN0IHx8IGZhbHNlOwogIG9wdGlvbnMuY29udGV4dCA9IG9wdHMuY29udGV4dDsKICBvcHRpb25zLmNhY2hlID0gb3B0cy5jYWNoZSB8fCBmYWxzZTsKICBvcHRpb25zLnJtV2hpdGVzcGFjZSA9IG9wdHMucm1XaGl0ZXNwYWNlOwogIG9wdGlvbnMucm9vdCA9IG9wdHMucm9vdDsKICBvcHRpb25zLm91dHB1dEZ1bmN0aW9uTmFtZSA9IG9wdHMub3V0cHV0RnVuY3Rpb25OYW1lOwogIG9wdGlvbnMubG9jYWxzTmFtZSA9IG9wdHMubG9jYWxzTmFtZSB8fCBleHBvcnRzLmxvY2Fsc05hbWUgfHwgX0RFRkFVTFRfTE9DQUxTX05BTUU7CiAgb3B0aW9ucy52aWV3cyA9IG9wdHMudmlld3M7CiAgb3B0aW9ucy5hc3luYyA9IG9wdHMuYXN5bmM7CiAgb3B0aW9ucy5kZXN0cnVjdHVyZWRMb2NhbHMgPSBvcHRzLmRlc3RydWN0dXJlZExvY2FsczsKICBvcHRpb25zLmxlZ2FjeUluY2x1ZGUgPSB0eXBlb2Ygb3B0cy5sZWdhY3lJbmNsdWRlICE9ICd1bmRlZmluZWQnID8gISFvcHRzLmxlZ2FjeUluY2x1ZGUgOiB0cnVlOwoKICBpZiAob3B0aW9ucy5zdHJpY3QpIHsKICAgIG9wdGlvbnMuX3dpdGggPSBmYWxzZTsKICB9IGVsc2UgewogICAgb3B0aW9ucy5fd2l0aCA9IHR5cGVvZiBvcHRzLl93aXRoICE9ICd1bmRlZmluZWQnID8gb3B0cy5fd2l0aCA6IHRydWU7CiAgfQoKICB0aGlzLm9wdHMgPSBvcHRpb25zOwogIHRoaXMucmVnZXggPSB0aGlzLmNyZWF0ZVJlZ2V4KCk7Cn0KClRlbXBsYXRlLm1vZGVzID0gewogIEVWQUw6ICdldmFsJywKICBFU0NBUEVEOiAnZXNjYXBlZCcsCiAgUkFXOiAncmF3JywKICBDT01NRU5UOiAnY29tbWVudCcsCiAgTElURVJBTDogJ2xpdGVyYWwnCn07ClRlbXBsYXRlLnByb3RvdHlwZSA9IHsKICBjcmVhdGVSZWdleDogZnVuY3Rpb24gY3JlYXRlUmVnZXgoKSB7CiAgICB2YXIgc3RyID0gX1JFR0VYX1NUUklORzsKICAgIHZhciBkZWxpbSA9IHV0aWxzLmVzY2FwZVJlZ0V4cENoYXJzKHRoaXMub3B0cy5kZWxpbWl0ZXIpOwogICAgdmFyIG9wZW4gPSB1dGlscy5lc2NhcGVSZWdFeHBDaGFycyh0aGlzLm9wdHMub3BlbkRlbGltaXRlcik7CiAgICB2YXIgY2xvc2UgPSB1dGlscy5lc2NhcGVSZWdFeHBDaGFycyh0aGlzLm9wdHMuY2xvc2VEZWxpbWl0ZXIpOwogICAgc3RyID0gc3RyLnJlcGxhY2UoLyUvZywgZGVsaW0pLnJlcGxhY2UoLzwvZywgb3BlbikucmVwbGFjZSgvPi9nLCBjbG9zZSk7CiAgICByZXR1cm4gbmV3IFJlZ0V4cChzdHIpOwogIH0sCiAgY29tcGlsZTogZnVuY3Rpb24gY29tcGlsZSgpIHsKICAgIHZhciBzcmM7CiAgICB2YXIgZm47CiAgICB2YXIgb3B0cyA9IHRoaXMub3B0czsKICAgIHZhciBwcmVwZW5kZWQgPSAnJzsKICAgIHZhciBhcHBlbmRlZCA9ICcnOwogICAgdmFyIGVzY2FwZUZuID0gb3B0cy5lc2NhcGVGdW5jdGlvbjsKICAgIHZhciBjdG9yOwoKICAgIGlmICghdGhpcy5zb3VyY2UpIHsKICAgICAgdGhpcy5nZW5lcmF0ZVNvdXJjZSgpOwogICAgICBwcmVwZW5kZWQgKz0gJyAgdmFyIF9fb3V0cHV0ID0gIiI7XG4nICsgJyAgZnVuY3Rpb24gX19hcHBlbmQocykgeyBpZiAocyAhPT0gdW5kZWZpbmVkICYmIHMgIT09IG51bGwpIF9fb3V0cHV0ICs9IHMgfVxuJzsKCiAgICAgIGlmIChvcHRzLm91dHB1dEZ1bmN0aW9uTmFtZSkgewogICAgICAgIHByZXBlbmRlZCArPSAnICB2YXIgJyArIG9wdHMub3V0cHV0RnVuY3Rpb25OYW1lICsgJyA9IF9fYXBwZW5kOycgKyAnXG4nOwogICAgICB9CgogICAgICBpZiAob3B0cy5kZXN0cnVjdHVyZWRMb2NhbHMgJiYgb3B0cy5kZXN0cnVjdHVyZWRMb2NhbHMubGVuZ3RoKSB7CiAgICAgICAgdmFyIGRlc3RydWN0dXJpbmcgPSAnICB2YXIgX19sb2NhbHMgPSAoJyArIG9wdHMubG9jYWxzTmFtZSArICcgfHwge30pLFxuJzsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcHRzLmRlc3RydWN0dXJlZExvY2Fscy5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmFyIG5hbWUgPSBvcHRzLmRlc3RydWN0dXJlZExvY2Fsc1tpXTsKCiAgICAgICAgICBpZiAoaSA+IDApIHsKICAgICAgICAgICAgZGVzdHJ1Y3R1cmluZyArPSAnLFxuICAnOwogICAgICAgICAgfQoKICAgICAgICAgIGRlc3RydWN0dXJpbmcgKz0gbmFtZSArICcgPSBfX2xvY2Fscy4nICsgbmFtZTsKICAgICAgICB9CgogICAgICAgIHByZXBlbmRlZCArPSBkZXN0cnVjdHVyaW5nICsgJztcbic7CiAgICAgIH0KCiAgICAgIGlmIChvcHRzLl93aXRoICE9PSBmYWxzZSkgewogICAgICAgIHByZXBlbmRlZCArPSAnICB3aXRoICgnICsgb3B0cy5sb2NhbHNOYW1lICsgJyB8fCB7fSkgeycgKyAnXG4nOwogICAgICAgIGFwcGVuZGVkICs9ICcgIH0nICsgJ1xuJzsKICAgICAgfQoKICAgICAgYXBwZW5kZWQgKz0gJyAgcmV0dXJuIF9fb3V0cHV0OycgKyAnXG4nOwogICAgICB0aGlzLnNvdXJjZSA9IHByZXBlbmRlZCArIHRoaXMuc291cmNlICsgYXBwZW5kZWQ7CiAgICB9CgogICAgaWYgKG9wdHMuY29tcGlsZURlYnVnKSB7CiAgICAgIHNyYyA9ICd2YXIgX19saW5lID0gMScgKyAnXG4nICsgJyAgLCBfX2xpbmVzID0gJyArIEpTT04uc3RyaW5naWZ5KHRoaXMudGVtcGxhdGVUZXh0KSArICdcbicgKyAnICAsIF9fZmlsZW5hbWUgPSAnICsgKG9wdHMuZmlsZW5hbWUgPyBKU09OLnN0cmluZ2lmeShvcHRzLmZpbGVuYW1lKSA6ICd1bmRlZmluZWQnKSArICc7JyArICdcbicgKyAndHJ5IHsnICsgJ1xuJyArIHRoaXMuc291cmNlICsgJ30gY2F0Y2ggKGUpIHsnICsgJ1xuJyArICcgIHJldGhyb3coZSwgX19saW5lcywgX19maWxlbmFtZSwgX19saW5lLCBlc2NhcGVGbik7JyArICdcbicgKyAnfScgKyAnXG4nOwogICAgfSBlbHNlIHsKICAgICAgc3JjID0gdGhpcy5zb3VyY2U7CiAgICB9CgogICAgaWYgKG9wdHMuY2xpZW50KSB7CiAgICAgIHNyYyA9ICdlc2NhcGVGbiA9IGVzY2FwZUZuIHx8ICcgKyBlc2NhcGVGbi50b1N0cmluZygpICsgJzsnICsgJ1xuJyArIHNyYzsKCiAgICAgIGlmIChvcHRzLmNvbXBpbGVEZWJ1ZykgewogICAgICAgIHNyYyA9ICdyZXRocm93ID0gcmV0aHJvdyB8fCAnICsgcmV0aHJvdy50b1N0cmluZygpICsgJzsnICsgJ1xuJyArIHNyYzsKICAgICAgfQogICAgfQoKICAgIGlmIChvcHRzLnN0cmljdCkgewogICAgICBzcmMgPSAnInVzZSBzdHJpY3QiO1xuJyArIHNyYzsKICAgIH0KCiAgICBpZiAob3B0cy5kZWJ1ZykgewogICAgICBjb25zb2xlLmxvZyhzcmMpOwogICAgfQoKICAgIGlmIChvcHRzLmNvbXBpbGVEZWJ1ZyAmJiBvcHRzLmZpbGVuYW1lKSB7CiAgICAgIHNyYyA9IHNyYyArICdcbicgKyAnLy8jIHNvdXJjZVVSTD0nICsgb3B0cy5maWxlbmFtZSArICdcbic7CiAgICB9CgogICAgdHJ5IHsKICAgICAgaWYgKG9wdHMuYXN5bmMpIHsKICAgICAgICAvLyBIYXZlIHRvIHVzZSBnZW5lcmF0ZWQgZnVuY3Rpb24gZm9yIHRoaXMsIHNpbmNlIGluIGVudnMgd2l0aG91dCBzdXBwb3J0LAogICAgICAgIC8vIGl0IGJyZWFrcyBpbiBwYXJzaW5nCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGN0b3IgPSBuZXcgRnVuY3Rpb24oJ3JldHVybiAoYXN5bmMgZnVuY3Rpb24oKXt9KS5jb25zdHJ1Y3RvcjsnKSgpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgU3ludGF4RXJyb3IpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIGVudmlyb25tZW50IGRvZXMgbm90IHN1cHBvcnQgYXN5bmMvYXdhaXQnKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGN0b3IgPSBGdW5jdGlvbjsKICAgICAgfQoKICAgICAgZm4gPSBuZXcgY3RvcihvcHRzLmxvY2Fsc05hbWUgKyAnLCBlc2NhcGVGbiwgaW5jbHVkZSwgcmV0aHJvdycsIHNyYyk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIC8vIGlzdGFuYnVsIGlnbm9yZSBlbHNlCiAgICAgIGlmIChlIGluc3RhbmNlb2YgU3ludGF4RXJyb3IpIHsKICAgICAgICBpZiAob3B0cy5maWxlbmFtZSkgewogICAgICAgICAgZS5tZXNzYWdlICs9ICcgaW4gJyArIG9wdHMuZmlsZW5hbWU7CiAgICAgICAgfQoKICAgICAgICBlLm1lc3NhZ2UgKz0gJyB3aGlsZSBjb21waWxpbmcgZWpzXG5cbic7CiAgICAgICAgZS5tZXNzYWdlICs9ICdJZiB0aGUgYWJvdmUgZXJyb3IgaXMgbm90IGhlbHBmdWwsIHlvdSBtYXkgd2FudCB0byB0cnkgRUpTLUxpbnQ6XG4nOwogICAgICAgIGUubWVzc2FnZSArPSAnaHR0cHM6Ly9naXRodWIuY29tL1J5YW5aaW0vRUpTLUxpbnQnOwoKICAgICAgICBpZiAoIW9wdHMuYXN5bmMpIHsKICAgICAgICAgIGUubWVzc2FnZSArPSAnXG4nOwogICAgICAgICAgZS5tZXNzYWdlICs9ICdPciwgaWYgeW91IG1lYW50IHRvIGNyZWF0ZSBhbiBhc3luYyBmdW5jdGlvbiwgcGFzcyBgYXN5bmM6IHRydWVgIGFzIGFuIG9wdGlvbi4nOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhyb3cgZTsKICAgIH0gLy8gUmV0dXJuIGEgY2FsbGFibGUgZnVuY3Rpb24gd2hpY2ggd2lsbCBleGVjdXRlIHRoZSBmdW5jdGlvbgogICAgLy8gY3JlYXRlZCBieSB0aGUgc291cmNlLWNvZGUsIHdpdGggdGhlIHBhc3NlZCBkYXRhIGFzIGxvY2FscwogICAgLy8gQWRkcyBhIGxvY2FsIGBpbmNsdWRlYCBmdW5jdGlvbiB3aGljaCBhbGxvd3MgZnVsbCByZWN1cnNpdmUgaW5jbHVkZQoKCiAgICB2YXIgcmV0dXJuZWRGbiA9IG9wdHMuY2xpZW50ID8gZm4gOiBmdW5jdGlvbiBhbm9ueW1vdXMoZGF0YSkgewogICAgICB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uIGluY2x1ZGUocGF0aCwgaW5jbHVkZURhdGEpIHsKICAgICAgICB2YXIgZCA9IHV0aWxzLnNoYWxsb3dDb3B5KHt9LCBkYXRhKTsKCiAgICAgICAgaWYgKGluY2x1ZGVEYXRhKSB7CiAgICAgICAgICBkID0gdXRpbHMuc2hhbGxvd0NvcHkoZCwgaW5jbHVkZURhdGEpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGluY2x1ZGVGaWxlKHBhdGgsIG9wdHMpKGQpOwogICAgICB9OwoKICAgICAgcmV0dXJuIGZuLmFwcGx5KG9wdHMuY29udGV4dCwgW2RhdGEgfHwge30sIGVzY2FwZUZuLCBpbmNsdWRlLCByZXRocm93XSk7CiAgICB9OwogICAgcmV0dXJuZWRGbi5kZXBlbmRlbmNpZXMgPSB0aGlzLmRlcGVuZGVuY2llczsKCiAgICBpZiAob3B0cy5maWxlbmFtZSAmJiB0eXBlb2YgT2JqZWN0LmRlZmluZVByb3BlcnR5ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHZhciBmaWxlbmFtZSA9IG9wdHMuZmlsZW5hbWU7CiAgICAgIHZhciBiYXNlbmFtZSA9IHBhdGguYmFzZW5hbWUoZmlsZW5hbWUsIHBhdGguZXh0bmFtZShmaWxlbmFtZSkpOwoKICAgICAgdHJ5IHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmV0dXJuZWRGbiwgJ25hbWUnLCB7CiAgICAgICAgICB2YWx1ZTogYmFzZW5hbWUsCiAgICAgICAgICB3cml0YWJsZTogZmFsc2UsCiAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgICAgIH0pOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgLyogaWdub3JlICovCiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcmV0dXJuZWRGbjsKICB9LAogIGdlbmVyYXRlU291cmNlOiBmdW5jdGlvbiBnZW5lcmF0ZVNvdXJjZSgpIHsKICAgIHZhciBvcHRzID0gdGhpcy5vcHRzOwoKICAgIGlmIChvcHRzLnJtV2hpdGVzcGFjZSkgewogICAgICAvLyBIYXZlIHRvIHVzZSB0d28gc2VwYXJhdGUgcmVwbGFjZSBoZXJlIGFzIGBeYCBhbmQgYCRgIG9wZXJhdG9ycyBkb24ndAogICAgICAvLyB3b3JrIHdlbGwgd2l0aCBgXHJgIGFuZCBlbXB0eSBsaW5lcyBkb24ndCB3b3JrIHdlbGwgd2l0aCB0aGUgYG1gIGZsYWcuCiAgICAgIHRoaXMudGVtcGxhdGVUZXh0ID0gdGhpcy50ZW1wbGF0ZVRleHQucmVwbGFjZSgvW1xyXG5dKy9nLCAnXG4nKS5yZXBsYWNlKC9eXHMrfFxzKyQvZ20sICcnKTsKICAgIH0gLy8gU2x1cnAgc3BhY2VzIGFuZCB0YWJzIGJlZm9yZSA8JV8gYW5kIGFmdGVyIF8lPgoKCiAgICB0aGlzLnRlbXBsYXRlVGV4dCA9IHRoaXMudGVtcGxhdGVUZXh0LnJlcGxhY2UoL1sgXHRdKjwlXy9nbSwgJzwlXycpLnJlcGxhY2UoL18lPlsgXHRdKi9nbSwgJ18lPicpOwogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgdmFyIG1hdGNoZXMgPSB0aGlzLnBhcnNlVGVtcGxhdGVUZXh0KCk7CiAgICB2YXIgZCA9IHRoaXMub3B0cy5kZWxpbWl0ZXI7CiAgICB2YXIgbyA9IHRoaXMub3B0cy5vcGVuRGVsaW1pdGVyOwogICAgdmFyIGMgPSB0aGlzLm9wdHMuY2xvc2VEZWxpbWl0ZXI7CgogICAgaWYgKG1hdGNoZXMgJiYgbWF0Y2hlcy5sZW5ndGgpIHsKICAgICAgbWF0Y2hlcy5mb3JFYWNoKGZ1bmN0aW9uIChsaW5lLCBpbmRleCkgewogICAgICAgIHZhciBvcGVuaW5nOwogICAgICAgIHZhciBjbG9zaW5nOwogICAgICAgIHZhciBpbmNsdWRlOwogICAgICAgIHZhciBpbmNsdWRlT3B0czsKICAgICAgICB2YXIgaW5jbHVkZU9iajsKICAgICAgICB2YXIgaW5jbHVkZVNyYzsgLy8gSWYgdGhpcyBpcyBhbiBvcGVuaW5nIHRhZywgY2hlY2sgZm9yIGNsb3NpbmcgdGFncwogICAgICAgIC8vIEZJWE1FOiBNYXkgZW5kIHVwIHdpdGggc29tZSBmYWxzZSBwb3NpdGl2ZXMgaGVyZQogICAgICAgIC8vIEJldHRlciB0byBzdG9yZSBtb2RlcyBhcyBrL3Ygd2l0aCBvcGVuRGVsaW1pdGVyICsgZGVsaW1pdGVyIGFzIGtleQogICAgICAgIC8vIFRoZW4gdGhpcyBjYW4gc2ltcGx5IGNoZWNrIGFnYWluc3QgdGhlIG1hcAoKICAgICAgICBpZiAobGluZS5pbmRleE9mKG8gKyBkKSA9PT0gMCAvLyBJZiBpdCBpcyBhIHRhZwogICAgICAgICYmIGxpbmUuaW5kZXhPZihvICsgZCArIGQpICE9PSAwKSB7CiAgICAgICAgICAvLyBhbmQgaXMgbm90IGVzY2FwZWQKICAgICAgICAgIGNsb3NpbmcgPSBtYXRjaGVzW2luZGV4ICsgMl07CgogICAgICAgICAgaWYgKCEoY2xvc2luZyA9PSBkICsgYyB8fCBjbG9zaW5nID09ICctJyArIGQgKyBjIHx8IGNsb3NpbmcgPT0gJ18nICsgZCArIGMpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgbWF0Y2hpbmcgY2xvc2UgdGFnIGZvciAiJyArIGxpbmUgKyAnIi4nKTsKICAgICAgICAgIH0KICAgICAgICB9IC8vIEhBQ0s6IGJhY2t3YXJkLWNvbXBhdCBgaW5jbHVkZWAgcHJlcHJvY2Vzc29yIGRpcmVjdGl2ZXMKCgogICAgICAgIGlmIChvcHRzLmxlZ2FjeUluY2x1ZGUgJiYgKGluY2x1ZGUgPSBsaW5lLm1hdGNoKC9eXHMqaW5jbHVkZVxzKyhcUyspLykpKSB7CiAgICAgICAgICBvcGVuaW5nID0gbWF0Y2hlc1tpbmRleCAtIDFdOyAvLyBNdXN0IGJlIGluIEVWQUwgb3IgUkFXIG1vZGUKCiAgICAgICAgICBpZiAob3BlbmluZyAmJiAob3BlbmluZyA9PSBvICsgZCB8fCBvcGVuaW5nID09IG8gKyBkICsgJy0nIHx8IG9wZW5pbmcgPT0gbyArIGQgKyAnXycpKSB7CiAgICAgICAgICAgIGluY2x1ZGVPcHRzID0gdXRpbHMuc2hhbGxvd0NvcHkoe30sIHNlbGYub3B0cyk7CiAgICAgICAgICAgIGluY2x1ZGVPYmogPSBpbmNsdWRlU291cmNlKGluY2x1ZGVbMV0sIGluY2x1ZGVPcHRzKTsKCiAgICAgICAgICAgIGlmIChzZWxmLm9wdHMuY29tcGlsZURlYnVnKSB7CiAgICAgICAgICAgICAgaW5jbHVkZVNyYyA9ICcgICAgOyAoZnVuY3Rpb24oKXsnICsgJ1xuJyArICcgICAgICB2YXIgX19saW5lID0gMScgKyAnXG4nICsgJyAgICAgICwgX19saW5lcyA9ICcgKyBKU09OLnN0cmluZ2lmeShpbmNsdWRlT2JqLnRlbXBsYXRlKSArICdcbicgKyAnICAgICAgLCBfX2ZpbGVuYW1lID0gJyArIEpTT04uc3RyaW5naWZ5KGluY2x1ZGVPYmouZmlsZW5hbWUpICsgJzsnICsgJ1xuJyArICcgICAgICB0cnkgeycgKyAnXG4nICsgaW5jbHVkZU9iai5zb3VyY2UgKyAnICAgICAgfSBjYXRjaCAoZSkgeycgKyAnXG4nICsgJyAgICAgICAgcmV0aHJvdyhlLCBfX2xpbmVzLCBfX2ZpbGVuYW1lLCBfX2xpbmUsIGVzY2FwZUZuKTsnICsgJ1xuJyArICcgICAgICB9JyArICdcbicgKyAnICAgIDsgfSkuY2FsbCh0aGlzKScgKyAnXG4nOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGluY2x1ZGVTcmMgPSAnICAgIDsgKGZ1bmN0aW9uKCl7JyArICdcbicgKyBpbmNsdWRlT2JqLnNvdXJjZSArICcgICAgOyB9KS5jYWxsKHRoaXMpJyArICdcbic7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNlbGYuc291cmNlICs9IGluY2x1ZGVTcmM7CiAgICAgICAgICAgIHNlbGYuZGVwZW5kZW5jaWVzLnB1c2goZXhwb3J0cy5yZXNvbHZlSW5jbHVkZShpbmNsdWRlWzFdLCBpbmNsdWRlT3B0cy5maWxlbmFtZSkpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzZWxmLnNjYW5MaW5lKGxpbmUpOwogICAgICB9KTsKICAgIH0KICB9LAogIHBhcnNlVGVtcGxhdGVUZXh0OiBmdW5jdGlvbiBwYXJzZVRlbXBsYXRlVGV4dCgpIHsKICAgIHZhciBzdHIgPSB0aGlzLnRlbXBsYXRlVGV4dDsKICAgIHZhciBwYXQgPSB0aGlzLnJlZ2V4OwogICAgdmFyIHJlc3VsdCA9IHBhdC5leGVjKHN0cik7CiAgICB2YXIgYXJyID0gW107CiAgICB2YXIgZmlyc3RQb3M7CgogICAgd2hpbGUgKHJlc3VsdCkgewogICAgICBmaXJzdFBvcyA9IHJlc3VsdC5pbmRleDsKCiAgICAgIGlmIChmaXJzdFBvcyAhPT0gMCkgewogICAgICAgIGFyci5wdXNoKHN0ci5zdWJzdHJpbmcoMCwgZmlyc3RQb3MpKTsKICAgICAgICBzdHIgPSBzdHIuc2xpY2UoZmlyc3RQb3MpOwogICAgICB9CgogICAgICBhcnIucHVzaChyZXN1bHRbMF0pOwogICAgICBzdHIgPSBzdHIuc2xpY2UocmVzdWx0WzBdLmxlbmd0aCk7CiAgICAgIHJlc3VsdCA9IHBhdC5leGVjKHN0cik7CiAgICB9CgogICAgaWYgKHN0cikgewogICAgICBhcnIucHVzaChzdHIpOwogICAgfQoKICAgIHJldHVybiBhcnI7CiAgfSwKICBfYWRkT3V0cHV0OiBmdW5jdGlvbiBfYWRkT3V0cHV0KGxpbmUpIHsKICAgIGlmICh0aGlzLnRydW5jYXRlKSB7CiAgICAgIC8vIE9ubHkgcmVwbGFjZSBzaW5nbGUgbGVhZGluZyBsaW5lYnJlYWsgaW4gdGhlIGxpbmUgYWZ0ZXIKICAgICAgLy8gLSU+IHRhZyAtLSB0aGlzIGlzIHRoZSBzaW5nbGUsIHRyYWlsaW5nIGxpbmVicmVhawogICAgICAvLyBhZnRlciB0aGUgdGFnIHRoYXQgdGhlIHRydW5jYXRpb24gbW9kZSByZXBsYWNlcwogICAgICAvLyBIYW5kbGUgV2luIC8gVW5peCAvIG9sZCBNYWMgbGluZWJyZWFrcyAtLSBkbyB0aGUgXHJcbgogICAgICAvLyBjb21ibyBmaXJzdCBpbiB0aGUgcmVnZXgtb3IKICAgICAgbGluZSA9IGxpbmUucmVwbGFjZSgvXig/OlxyXG58XHJ8XG4pLywgJycpOwogICAgICB0aGlzLnRydW5jYXRlID0gZmFsc2U7CiAgICB9CgogICAgaWYgKCFsaW5lKSB7CiAgICAgIHJldHVybiBsaW5lOwogICAgfSAvLyBQcmVzZXJ2ZSBsaXRlcmFsIHNsYXNoZXMKCgogICAgbGluZSA9IGxpbmUucmVwbGFjZSgvXFwvZywgJ1xcXFwnKTsgLy8gQ29udmVydCBsaW5lYnJlYWtzCgogICAgbGluZSA9IGxpbmUucmVwbGFjZSgvXG4vZywgJ1xcbicpOwogICAgbGluZSA9IGxpbmUucmVwbGFjZSgvXHIvZywgJ1xccicpOyAvLyBFc2NhcGUgZG91YmxlLXF1b3RlcwogICAgLy8gLSB0aGlzIHdpbGwgYmUgdGhlIGRlbGltaXRlciBkdXJpbmcgZXhlY3V0aW9uCgogICAgbGluZSA9IGxpbmUucmVwbGFjZSgvIi9nLCAnXFwiJyk7CiAgICB0aGlzLnNvdXJjZSArPSAnICAgIDsgX19hcHBlbmQoIicgKyBsaW5lICsgJyIpJyArICdcbic7CiAgfSwKICBzY2FuTGluZTogZnVuY3Rpb24gc2NhbkxpbmUobGluZSkgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgdmFyIGQgPSB0aGlzLm9wdHMuZGVsaW1pdGVyOwogICAgdmFyIG8gPSB0aGlzLm9wdHMub3BlbkRlbGltaXRlcjsKICAgIHZhciBjID0gdGhpcy5vcHRzLmNsb3NlRGVsaW1pdGVyOwogICAgdmFyIG5ld0xpbmVDb3VudCA9IDA7CiAgICBuZXdMaW5lQ291bnQgPSBsaW5lLnNwbGl0KCdcbicpLmxlbmd0aCAtIDE7CgogICAgc3dpdGNoIChsaW5lKSB7CiAgICAgIGNhc2UgbyArIGQ6CiAgICAgIGNhc2UgbyArIGQgKyAnXyc6CiAgICAgICAgdGhpcy5tb2RlID0gVGVtcGxhdGUubW9kZXMuRVZBTDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgbyArIGQgKyAnPSc6CiAgICAgICAgdGhpcy5tb2RlID0gVGVtcGxhdGUubW9kZXMuRVNDQVBFRDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgbyArIGQgKyAnLSc6CiAgICAgICAgdGhpcy5tb2RlID0gVGVtcGxhdGUubW9kZXMuUkFXOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBvICsgZCArICcjJzoKICAgICAgICB0aGlzLm1vZGUgPSBUZW1wbGF0ZS5tb2Rlcy5DT01NRU5UOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBvICsgZCArIGQ6CiAgICAgICAgdGhpcy5tb2RlID0gVGVtcGxhdGUubW9kZXMuTElURVJBTDsKICAgICAgICB0aGlzLnNvdXJjZSArPSAnICAgIDsgX19hcHBlbmQoIicgKyBsaW5lLnJlcGxhY2UobyArIGQgKyBkLCBvICsgZCkgKyAnIiknICsgJ1xuJzsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgZCArIGQgKyBjOgogICAgICAgIHRoaXMubW9kZSA9IFRlbXBsYXRlLm1vZGVzLkxJVEVSQUw7CiAgICAgICAgdGhpcy5zb3VyY2UgKz0gJyAgICA7IF9fYXBwZW5kKCInICsgbGluZS5yZXBsYWNlKGQgKyBkICsgYywgZCArIGMpICsgJyIpJyArICdcbic7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIGQgKyBjOgogICAgICBjYXNlICctJyArIGQgKyBjOgogICAgICBjYXNlICdfJyArIGQgKyBjOgogICAgICAgIGlmICh0aGlzLm1vZGUgPT0gVGVtcGxhdGUubW9kZXMuTElURVJBTCkgewogICAgICAgICAgdGhpcy5fYWRkT3V0cHV0KGxpbmUpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5tb2RlID0gbnVsbDsKICAgICAgICB0aGlzLnRydW5jYXRlID0gbGluZS5pbmRleE9mKCctJykgPT09IDAgfHwgbGluZS5pbmRleE9mKCdfJykgPT09IDA7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIC8vIEluIHNjcmlwdCBtb2RlLCBkZXBlbmRzIG9uIHR5cGUgb2YgdGFnCiAgICAgICAgaWYgKHRoaXMubW9kZSkgewogICAgICAgICAgLy8gSWYgJy8vJyBpcyBmb3VuZCB3aXRob3V0IGEgbGluZSBicmVhaywgYWRkIGEgbGluZSBicmVhay4KICAgICAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7CiAgICAgICAgICAgIGNhc2UgVGVtcGxhdGUubW9kZXMuRVZBTDoKICAgICAgICAgICAgY2FzZSBUZW1wbGF0ZS5tb2Rlcy5FU0NBUEVEOgogICAgICAgICAgICBjYXNlIFRlbXBsYXRlLm1vZGVzLlJBVzoKICAgICAgICAgICAgICBpZiAobGluZS5sYXN0SW5kZXhPZignLy8nKSA+IGxpbmUubGFzdEluZGV4T2YoJ1xuJykpIHsKICAgICAgICAgICAgICAgIGxpbmUgKz0gJ1xuJzsKICAgICAgICAgICAgICB9CgogICAgICAgICAgfQoKICAgICAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7CiAgICAgICAgICAgIC8vIEp1c3QgZXhlY3V0aW5nIGNvZGUKICAgICAgICAgICAgY2FzZSBUZW1wbGF0ZS5tb2Rlcy5FVkFMOgogICAgICAgICAgICAgIHRoaXMuc291cmNlICs9ICcgICAgOyAnICsgbGluZSArICdcbic7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIC8vIEV4ZWMsIGVzYywgYW5kIG91dHB1dAoKICAgICAgICAgICAgY2FzZSBUZW1wbGF0ZS5tb2Rlcy5FU0NBUEVEOgogICAgICAgICAgICAgIHRoaXMuc291cmNlICs9ICcgICAgOyBfX2FwcGVuZChlc2NhcGVGbignICsgc3RyaXBTZW1pKGxpbmUpICsgJykpJyArICdcbic7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIC8vIEV4ZWMgYW5kIG91dHB1dAoKICAgICAgICAgICAgY2FzZSBUZW1wbGF0ZS5tb2Rlcy5SQVc6CiAgICAgICAgICAgICAgdGhpcy5zb3VyY2UgKz0gJyAgICA7IF9fYXBwZW5kKCcgKyBzdHJpcFNlbWkobGluZSkgKyAnKScgKyAnXG4nOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBUZW1wbGF0ZS5tb2Rlcy5DT01NRU5UOgogICAgICAgICAgICAgIC8vIERvIG5vdGhpbmcKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgLy8gTGl0ZXJhbCA8JSUgbW9kZSwgYXBwZW5kIGFzIHJhdyBvdXRwdXQKCiAgICAgICAgICAgIGNhc2UgVGVtcGxhdGUubW9kZXMuTElURVJBTDoKICAgICAgICAgICAgICB0aGlzLl9hZGRPdXRwdXQobGluZSk7CgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0gLy8gSW4gc3RyaW5nIG1vZGUsIGp1c3QgYWRkIHRoZSBvdXRwdXQKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgdGhpcy5fYWRkT3V0cHV0KGxpbmUpOwogICAgICAgICAgfQoKICAgIH0KCiAgICBpZiAoc2VsZi5vcHRzLmNvbXBpbGVEZWJ1ZyAmJiBuZXdMaW5lQ291bnQpIHsKICAgICAgdGhpcy5jdXJyZW50TGluZSArPSBuZXdMaW5lQ291bnQ7CiAgICAgIHRoaXMuc291cmNlICs9ICcgICAgOyBfX2xpbmUgPSAnICsgdGhpcy5jdXJyZW50TGluZSArICdcbic7CiAgICB9CiAgfQp9OwovKioKICogRXNjYXBlIGNoYXJhY3RlcnMgcmVzZXJ2ZWQgaW4gWE1MLgogKgogKiBUaGlzIGlzIHNpbXBseSBhbiBleHBvcnQgb2Yge0BsaW5rIG1vZHVsZTp1dGlscy5lc2NhcGVYTUx9LgogKgogKiBJZiBgbWFya3VwYCBpcyBgdW5kZWZpbmVkYCBvciBgbnVsbGAsIHRoZSBlbXB0eSBzdHJpbmcgaXMgcmV0dXJuZWQuCiAqCiAqIEBwYXJhbSB7U3RyaW5nfSBtYXJrdXAgSW5wdXQgc3RyaW5nCiAqIEByZXR1cm4ge1N0cmluZ30gRXNjYXBlZCBzdHJpbmcKICogQHB1YmxpYwogKiBAZnVuYwogKiAqLwoKZXhwb3J0cy5lc2NhcGVYTUwgPSB1dGlscy5lc2NhcGVYTUw7Ci8qKgogKiBFeHByZXNzLmpzIHN1cHBvcnQuCiAqCiAqIFRoaXMgaXMgYW4gYWxpYXMgZm9yIHtAbGluayBtb2R1bGU6ZWpzLnJlbmRlckZpbGV9LCBpbiBvcmRlciB0byBzdXBwb3J0CiAqIEV4cHJlc3MuanMgb3V0LW9mLXRoZS1ib3guCiAqCiAqIEBmdW5jCiAqLwoKZXhwb3J0cy5fX2V4cHJlc3MgPSBleHBvcnRzLnJlbmRlckZpbGU7IC8vIEFkZCByZXF1aXJlIHN1cHBvcnQKCi8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovCgppZiAocmVxdWlyZS5leHRlbnNpb25zKSB7CiAgcmVxdWlyZS5leHRlbnNpb25zWycuZWpzJ10gPSBmdW5jdGlvbiAobW9kdWxlLCBmbG5tKSB7CiAgICBjb25zb2xlLmxvZygnRGVwcmVjYXRlZDogdGhpcyBBUEkgd2lsbCBnbyBhd2F5IGluIEVKUyB2Mi44Jyk7CiAgICB2YXIgZmlsZW5hbWUgPSBmbG5tIHx8CiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwogICAgbW9kdWxlLmZpbGVuYW1lOwogICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgIGZpbGVuYW1lOiBmaWxlbmFtZSwKICAgICAgY2xpZW50OiB0cnVlCiAgICB9OwogICAgdmFyIHRlbXBsYXRlID0gZmlsZUxvYWRlcihmaWxlbmFtZSkudG9TdHJpbmcoKTsKICAgIHZhciBmbiA9IGV4cG9ydHMuY29tcGlsZSh0ZW1wbGF0ZSwgb3B0aW9ucyk7CgogICAgbW9kdWxlLl9jb21waWxlKCdtb2R1bGUuZXhwb3J0cyA9ICcgKyBmbi50b1N0cmluZygpICsgJzsnLCBmaWxlbmFtZSk7CiAgfTsKfQovKioKICogVmVyc2lvbiBvZiBFSlMuCiAqCiAqIEByZWFkb25seQogKiBAdHlwZSB7U3RyaW5nfQogKiBAcHVibGljCiAqLwoKCmV4cG9ydHMuVkVSU0lPTiA9IF9WRVJTSU9OX1NUUklORzsKLyoqCiAqIE5hbWUgZm9yIGRldGVjdGlvbiBvZiBFSlMuCiAqCiAqIEByZWFkb25seQogKiBAdHlwZSB7U3RyaW5nfQogKiBAcHVibGljCiAqLwoKZXhwb3J0cy5uYW1lID0gX05BTUU7Ci8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwoKaWYgKHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcpIHsKICB3aW5kb3cuZWpzID0gZXhwb3J0czsKfQ=="},null]}